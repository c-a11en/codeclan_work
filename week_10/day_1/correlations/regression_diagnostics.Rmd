---
title: "R Notebook"
output: html_notebook
---

```{r}

library(tidyverse)
library(modelr)

```

```{r}

height <- c(176, 164, 181, 168, 195, 185, 166, 180, 188, 174)
weight <- c(82, 65, 85, 76, 90, 92, 68, 83, 94, 74 )

sample <- tibble(
  weight,
  height
)

```


```{r}

model <- lm(height ~ weight,
            sample)

summary(model)

```
```{r}

library(broom)

```

```{r}
# coefficients and stats from model
model %>% 
  tidy()

```

```{r}
# other statistics from model
glance_output <- model %>% 
  glance() %>% 
  janitor::clean_names()

glance_output

```

```{r}

tidy_output <- model %>% 
  tidy() %>% 
  janitor::clean_names()

tidy_output

```

```{r}

glance_output$r_squared

```

```{r}

sample %>% 
  summarise(correl = cor(weight, height),
            sq_correl = correl ^ 2)

```


```{r}

library(ggfortify)

autoplot(model)

```

# Task - 15 minutes

```{r}

distribution_1 <- read_csv("data/distribution_1.csv")
distribution_2 <- read_csv("data/distribution_2.csv")

```

```{r}

model1 <- lm(y ~ x,
            distribution_1)

autoplot(model1)

```

The residuals are dependant on the fitted values, i.e. the residuals start negative, become positive in the middle of the dataset and then become more negative at higher values again.


```{r}

distribution_1 %>% 
  add_predictions(model1) %>% 
  ggplot(aes(x = x)) +
  geom_point(aes(y = y)) +
  geom_line(aes(y = pred), col = "red")

```


```{r}

model2 <- lm(y ~ x,
            distribution_2)

autoplot(model2)

```
The residuals tend to increase at higher values, this can be shown in the sqrt of standardised residuals plot which shows a steady rise as fitted values prediction increases.

```{r}

distribution_2 %>% 
  add_predictions(model2) %>% 
  ggplot(aes(x = x)) +
  geom_point(aes(y = y)) +
  geom_line(aes(y = pred), col = "red")

```

```{r}

library(infer)

```

```{r}

bootstrap_dist_slope <- distribution_2 %>% 
  specify(formula = y ~ x) %>% 
  generate(reps = 10000, type = "bootstrap") %>% 
  calculate(stat = "slope")

slope_ci95 <- bootstrap_dist_slope %>% 
  get_ci(level = 0.95, type = "percentile")

slope_ci95

```

```{r}

bootstrap_dist_slope %>% 
  visualise(bins = 30) +
  shade_ci(endpoints = slope_ci95)

```

```{r}

model2 %>% tidy(conf.int  = TRUE, conf.level  = 0.95) %>% 
  janitor::clean_names()

```

